window.chesscom=window.chesscom||{},window.chesscom.routes=window.chesscom.routes||{},Object.assign(window.chesscom.routes,{web_classroom_room:{tokens:[["variable","/","[^/]++","id"],["text","/classroom"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_classroom_room:{tokens:[["variable","/","[^/]++","id"],["text","/classroom"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{subdomain:"www",_locale:""},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_security_login_and_go:{tokens:[["text","/login_and_go"]],defaults:{subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_security_login_and_go:{tokens:[["text","/login_and_go"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{subdomain:"www",_locale:""},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},web_insights:{tokens:[["variable","/","[^/]++","username"],["text","/insights"]],defaults:{username:null,subdomain:"www"},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]},i18n_web_insights:{tokens:[["variable","/","[^/]++","username"],["text","/insights"],["variable","/","es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--","_locale"]],defaults:{username:null,subdomain:"www",_locale:""},requirements:{subdomain:"www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy",_locale:"es|fr|de|pl|ru|sv|el|pt|it|zh|ja|ko|nl|hy|bg|hr|cs|da|fi|hu|lt|no|ro|sk|sl|tr|uk|af|ar|az|be|bs|et|fa|gl|he|hi|id|is|ka|lv|ms|pt-BR|sq|sr|vi|zh-HK|zh-TW|fil|nl-BE|bn|tk|uz|ca|ur|--locale--"},hosttokens:[["text",".chess.com"],["variable","","www|schach|ru|uk|ajedrez|fr|scacchi|sakk|schaken|szachy","subdomain"]],methods:[],schemes:["https"]}}),(("undefined"!=typeof self?self:this).wpChessCom_EovE=("undefined"!=typeof self?self:this).wpChessCom_EovE||[]).push([[468],{6399:function(e,t,n){"use strict";function loadLazyStyle(e){const t=document.querySelector(`link[data-href*="/${e}.client"]`);t&&(t.setAttribute("href",t.getAttribute("data-href")),t.removeAttribute("data-href"))}n.d(t,{E:function(){return loadLazyStyle}})},4164:function(e,t,n){"use strict";n.d(t,{i:function(){return getMessageFromError}});var s=n(9790);n(8160);const getMessageFromError=e=>{if(e.response&&401!==e.response.status)return(e.response.data&&e.response.data.message?e.response.data.message:s.R0.badRequest)||e.response.statusText}},9790:function(e,t,n){"use strict";n.d(t,{jC:function(){return r},R0:function(){return i},sY:function(){return o},xL:function(){return a},V5:function(){return c}});var s=n(8160);const r=7e3,i={badRequest:s.Z.trans("Oops. Looks like there was an error. Sorry! Please refresh.")},o={avatarUploaded:s.Z.trans("Avatar uploaded"),commentCreated:s.Z.trans("Thank you for your comment."),commentDeleted:s.Z.trans("Comment deleted."),commentEmptyContent:s.Z.trans("You cannot send an empty comment"),commentUpdated:s.Z.trans("Comment updated."),commentLinkCopied:s.Z.trans("Comment link is copied to clipboard"),copied:s.Z.trans("Copied to clipboard"),forumsMarkedAsRead:s.Z.trans("All forum topics have been marked as read"),featureContent:s.Z.trans("Feature Set! It might take a minute or two to appear."),inviteEmpty:s.Z.trans("Please select the players for whom to send the invitation"),inviteSent:s.Z.trans("Your invitations were sent successfully"),pgnCopied:s.Z.trans("PGN copied to buffer")},a={ALERT_FLASH_CONTAINER:"widget-alert-flash",DISMISSING:"alert-banner-dismissing"},c={error:"error",info:"info",success:"success"};c.error,i.badRequest},1302:function(e,t,n){"use strict";n.d(t,{OD:function(){return dismissAlert},C4:function(){return createAlertElement}});var s=n(6399),r=n(9790);function dismissAlert(e){const t=document.getElementById(`alert-${e}`);t&&hideAlertElement(t)}function createAlertElement(e){var t;e.type!==r.V5.success&&function dismissAllButLast(e=2){var t;const n=getContainer();Array.from(null!=(t=null==n?void 0:n.querySelectorAll(`.alerts-alert:not(:nth-last-child(-n + ${e}))`))?t:[]).forEach(hideAlertElement)}(2),(0,s.E)("alerts");const n=document.createElement("div");n.classList.add("alerts-alert"),n.classList.add("alerts-enter"),n.classList.add(`alerts-${e.type}`),n.setAttribute("id",`alert-${e.id}`);const i=document.createElement("span");i.classList.add("alerts-message"),i.innerHTML=e.message;const o=document.createElement("button");o.classList.add("alerts-close"),o.setAttribute("type","button"),o.innerHTML='<span class="icon-font-chess x"></span>',n.appendChild(i),n.appendChild(o),null==(t=getContainer())||t.appendChild(n),o.addEventListener("click",onClickClose),e.type===r.V5.success&&setTimeout(hideAlertElement,r.jC,n)}function getContainer(){return document.getElementById(r.xL.ALERT_FLASH_CONTAINER)}function hideAlertElement(e){e.classList.add("alerts-leave"),setTimeout(removeAlertElement,200,e)}function removeAlertElement(e){var t;try{null==(t=getContainer())||t.removeChild(e)}catch(n){!function clearAlerts(){const e=getContainer();e&&(e.innerHTML="")}()}}function onClickClose(e){var t,n;const s=null==(n=null==(t=e.target)?void 0:t.closest)?void 0:n.call(t,".alerts-alert");s&&hideAlertElement(s)}},5291:function(e,t,n){"use strict";n.d(t,{OD:function(){return r.OD},el:function(){return createAlert},x2:function(){return showError}});var s=n(9790),r=n(1302),i=n(4752),o=n.n(i);function createAlert({message:e,type:t,id:n}){(0,r.C4)({id:null!=n?n:o()(),type:t,message:e})}function showError(e=s.R0.badRequest){createAlert({type:s.V5.error,message:e})}},8294:function(e,t,n){"use strict";n.r(t),n.d(t,{setupInvitations:function(){return setupInvitations}});var s=n(8598),r=n(5291);let i=100;function delayedAction(e,t){setTimeout((()=>{e in window.toaster?(i=0,window.toaster[e](t)):(i*=2,delayedAction(e,t))}),i)}var o=window.toaster||{add(e){delayedAction("add",e)},remove(e){delayedAction("remove",e)}},a=(e=>(e[e.Toaster=0]="Toaster",e[e.Alert=1]="Alert",e))(a||{});const c={notifications:[]};var u=n(7943);function hideNotifications(e){c.notifications.filter((t=>!e||(!e.keys||e.keys.every((e=>t.keys.includes(e))))&&(!e.type||e.type===t.type)&&(!e.id||e.id===t.id))).forEach((e=>{e.type===a.Toaster?o.remove(e.id):e.type===a.Alert&&(0,r.OD)(e.id),(0,u.A)(c.notifications,e)}))}var l=(e=>(e.ClassroomInvitation="ClassroomInvitation",e.PuzzleBattleChallenge="PuzzleBattleChallenge",e.MatcherChallenge="MatcherChallenge",e.InsightsReminder="InsightsReminder",e.SessionExpired="SessionExpired",e))(l||{});var d=n(4752),h=n.n(d);function showNotification(e){var t,n,s,i,u,l;const d={type:null!=(t=e.type)?t:a.Alert,keys:null!=(n=e.keys)?n:[],id:h()()};e.unique&&hideNotifications({type:e.type,keys:e.keys}),e.duration&&setTimeout(hideNotifications,e.duration,{id:d.id}),d.type===a.Toaster?null==(u=o)||u.add({id:d.id,duration:e.duration,content:null!=(s=e.content)?s:"",theme:null!=(i=e.theme)?i:"info",icon:e.icon,links:e.links,avatarUrl:e.avatarUrl}):d.type===a.Alert&&(0,r.el)({id:d.id,type:e.theme||"info",message:null!=(l=e.content)?l:""}),c.notifications.push(d)}var b=Object.defineProperty,m=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function showAlert(e){showNotification(((e,t)=>{for(var n in t||(t={}))p.call(t,n)&&__defNormalProp(e,n,t[n]);if(m)for(var n of m(t))f.call(t,n)&&__defNormalProp(e,n,t[n]);return e})({type:a.Alert},e))}var w=n(4164);function showHttpError(e){!function showError(e){showAlert({duration:1e4,theme:"error",content:e})}((0,w.i)(e))}var g=Object.defineProperty,y=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,show_toaster_defNormalProp=(e,t,n)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function showToaster(e){showNotification(((e,t)=>{for(var n in t||(t={}))k.call(t,n)&&show_toaster_defNormalProp(e,n,t[n]);if(y)for(var n of y(t))v.call(t,n)&&show_toaster_defNormalProp(e,n,t[n]);return e})({type:a.Toaster},e))}var z=n(7074).Z.create({withCredentials:!0});var C=n(9626),A=Object.defineProperty,E=Object.defineProperties,S=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,publish_defNormalProp=(e,t,n)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;async function publish_publish(e){var t,n,s,r;return async function publish(e){var t;let n=window.PubSub.options.url[e.service||"base"];const s=e.path instanceof Array?e.path.join("/"):e.path;n.endsWith("/")||s.startsWith("/")||(n+="/");const r={};["staging","prod"].includes("staging")||(r.uid=null==(t=window.context.user)?void 0:t.uuid),e.params&&Object.assign(r,e.params);const i={};return e.requestId&&(i["x-chesscom-request-id-client"]=e.requestId),e.clientId&&(i["x-chesscom-play-client"]=e.clientId),e.headers&&Object.assign(i,e.headers),z({url:/^http[s]?:/.test(s)?s:`${n}${s}`,data:e.data,method:e.method||"post",params:r,headers:i,withCredentials:!0})}((s=((e,t)=>{for(var n in t||(t={}))j.call(t,n)&&publish_defNormalProp(e,n,t[n]);if(P)for(var n of P(t))_.call(t,n)&&publish_defNormalProp(e,n,t[n]);return e})({},e),r={requestId:h()(),clientId:null==(n=(t=C.q).getClientId)?void 0:n.call(t)},E(s,S(r))))}var O=n(425),T=n(2305);function handleClassroomMessage({message:e}){e.added.forEach((e=>{!function showClassroomInvitation(e){const t=(0,T.dW)("%username% invited you to Classroom",{"%username%":e.creator.username});showToaster({keys:[l.ClassroomInvitation,e.id],icon:"chess-board",duration:0,avatarUrl:e.creator.avatarUrl,content:t,links:[{label:(0,T.dW)("Decline"),onClick:async()=>{try{await publish_publish({path:e.decline})}catch(t){showHttpError(t)}}},{label:(0,T.dW)("Accept"),onClick:async()=>{try{const{data:{sessionId:t}}=await publish_publish({path:e.accept});window.location.href=O.Z.generate("web_classroom_room",{id:t},!0)}catch(t){showHttpError(t)}}}]})}(e)})),e.removed.forEach((e=>{!function hideClassroomInvitation(e){hideNotifications({keys:[l.ClassroomInvitation,e.id]})}(e)}))}var I=n(7080);Object.create,Object.defineProperty,Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.getPrototypeOf,Object.prototype.hasOwnProperty;var x=n(3775);function getSubscriptionChannel(e){return(0,x.HD)(e)?e:e.join("/")}function isAlternativePubSub(e){return Boolean(e&&"/pubsub"!==e&&"/pubsub/"!==e)}function getSubscriptionKey({channel:e,pubsub:t}){return isAlternativePubSub(t)?`${t}$${getSubscriptionChannel(e)}`:getSubscriptionChannel(e)}function unsubscribePubSubChannel(e){var t;const n=getSubscriptionKey(e);if(null==(t=I.z.subscriptions[n])||t.close(),delete I.z.subscriptions[n],delete I.z.subscribing[n],!isAlternativePubSub(e.pubsub))return;!Object.keys(I.z.subscriptions).filter((t=>t.split("$")[0]===e.pubsub)).length&&I.z.clients[e.pubsub]&&(I.z.clients[e.pubsub].close(),delete I.z.clients[e.pubsub])}var q=n(2111);function isPubSubConnected(){return I.z.reactive.isConnected}var R=n(4158);class SubscriptionError extends Error{constructor(e,t){super(`failed to subscribe to ${e} (code: ${null==t?void 0:t.code})`),this.channel=e,this.failure=t}}var L=n(8508);async function subscribePubSubChannel(e){if(I.z.waitingForClient)return I.z.waitingForClient;isAlternativePubSub(e.pubsub)?await async function connectPubSubClient(e){return e in I.z.connecting?I.z.connecting[e]:I.z.clients[e]?void 0:(I.z.connecting[e]=new Promise(((t,s)=>{var r,i;const o={debug:!1,maxReconnectionDelayMs:5e3,reconnectionDelayPowBase:1.3,uid:null==(i=null==(r=window.context)?void 0:r.user)?void 0:i.uuid,url:window.PubSub.options.url.pubsub.replace(/\/pubsub$/,e)},a={onAttach:()=>{delete I.z.connecting[e],t()},onConnect:()=>{delete I.z.connecting[e],t()},onDetach:()=>{delete I.z.connecting[e],delete I.z.clients[e],s()},onFailure:t=>{delete I.z.connecting[e],delete I.z.clients[e],s(t)}};n.e(9401).then(n.bind(n,9401)).then((({default:t})=>{I.z.clients[e]=t.connect(o,a)}))})),I.z.connecting[e])}(e.pubsub):isPubSubConnected()||await async function waitForPubSubConnection(){if(!(0,R.q)())throw new Error("PubSub.client script not found in document");if(I.z.waitingForClient&&await I.z.waitingForClient,(0,q.R)(),!isPubSubConnected())return new Promise((e=>{const onConnect=()=>{window.PubSub.off(s.LZ.CONNECT,onConnect),window.PubSub.off(s.LZ.RECONNECT,onConnect),e()};window.PubSub.on(s.LZ.CONNECT,onConnect),window.PubSub.on(s.LZ.RECONNECT,onConnect)}))}();const t=getSubscriptionKey(e);return t in I.z.subscribing?I.z.subscribing[t]:I.z.subscriptions[t]?void 0:(I.z.subscribing[t]=new Promise(((n,r)=>{const i=getSubscriptionChannel(e.channel),o=isAlternativePubSub(e.pubsub)?I.z.clients[e.pubsub]:s.pS,a=setTimeout((()=>{t in I.z.subscribing&&((0,L.T)("time out while subscribing to PubSub",{channel:i}),unsubscribePubSubChannel({channel:i,pubsub:e.pubsub}))}),3e4),c=o.subscribe(i,{onDetach(){clearTimeout(a)},onAttach(){clearTimeout(a),delete I.z.subscribing[t],I.z.subscriptions[t]=c,n()},onFailure(e){clearTimeout(a),delete I.z.subscribing[t],r(new SubscriptionError(i,e))},onMessage(t){i in I.z.subscribing&&(0,L.T)("onMessage PubSub hook fired before onAttach",{channel:i}),Promise.resolve({channel:i,message:t}).then(e.onMessage)},onComplete(){clearTimeout(a),unsubscribePubSubChannel({channel:i,pubsub:e.pubsub}),n()}})})),I.z.subscribing[t])}async function subscribeAuthenticatedChannel(e,t){var n;try{await function subscribeChannel(e,t){return subscribePubSubChannel({channel:e,onMessage:t})}(e,t)}catch(s){if(401!==(null==(n=s.failure)?void 0:n.code))throw s;!function showSessionExpired(){showToaster({keys:[l.SessionExpired],unique:!0,icon:"circle-danger",duration:0,content:(0,T.dW)("Looks like you’re logged out!"),links:[{label:(0,T.dW)("Please log back in"),onClick:()=>{window.location.href=O.Z.generate("web_security_login_and_go",{returnUrl:window.location.href})}}]})}()}}function showInsightsReminder(){showToaster({keys:[l.InsightsReminder],unique:!0,icon:"lightbulb",duration:0,content:(0,T.dW)("Your insights are ready!"),links:[{label:(0,T.dW)("Click here to see them now"),onClick:()=>{const e=new URL(O.Z.generate("web_insights",{},!0));e.searchParams.set("toaster","true"),window.location.href=e.toString()}}]})}function setupInvitations(){!async function subscribeClassroom(){return subscribeAuthenticatedChannel([s.AM.Invitations,s.jq.Users,":me"],handleClassroomMessage)}(),async function subscribeInsights(){if(window.location.pathname===O.Z.generate("web_insights"))return;return subscribeAuthenticatedChannel([s.AM.Insights,"backfilling",window.context.user.uuid],showInsightsReminder)}()}},4752:function(e){e.exports=function uid(e){return e=e||7,Math.random().toString(35).substr(2,e)}}}]);